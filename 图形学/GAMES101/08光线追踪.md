# 光栅化和光线追踪的比较

光栅化对于一些全局效果Global Effect 表现并不是很好，比如：软阴影、多次光线弹射

光栅化计算速度快，但是渲染质量相对较低

光线追踪计算准确，但是计算速度慢

# 光线的定义

1. 光线沿直线传播（在真实物理中是错误的）
2. 光线之间不会发生碰撞（在真实物理中是错误的）
3. 光线从光源传播到场景中，在场景中不断反射折射后到人眼（摄像机）中，具有可逆性Invariant

# 光线投射Ray Casting

得到射线与场景中最近的交点（不需要深度测试），计算交点的法线和着色，写入像素的颜色缓存

# Whitted-Style Ray Tracing

在任意一个交点，光线可以继续传播，无论是反射还是折射

# Ray Equation

光线可以用一个点加一个方向来定义 r(t) = o + t*d (0 <= t < max)

# Ray Interscetion With Implicit Surface

f(o + t*d) = 0解出t的值，t大于等于0并且是实数

# Ray Intersection With Triangle Mesh

遍历所有三角面判断光线是否和三角面相交

传统方法：
1. 判断光线是否和三角形所在平面相交
2. 如果相交，判断交点是否在三角形内部（和判断像素点是否在三角形内部同理）

Moller Trumbore Algorithm：
直接求解光线与三角形重心坐标相等的表达式，再判断解是否合理


应用：从一个点出发随便往一个方向做一条射线，如果和几何的交点个数是奇数，则这个点在几何的内部，如果是偶数，则在几何的外部

# 包围盒 Bounding Box

长方体的本质：Three Pairs Of Slabs的交集

最常用的包围盒：轴对齐包围盒 AABB Axis-Aligned Bounding Box

光线和AABB包围盒求交的方法：对每对Slab分别计算tmin和tmax，tenter（进入时间）三组tmin取最大，texit（离开时间）三组tmax取最小

当tenter小于texit并且texit大于0时，光线与包围盒AABB相交

轴对齐的平面光线相交运算相比于普通平面光线相交运算简化很多

# 直线的光栅化：Bresenham算法

# 网格 Build Acceleration Grid

Grid不能太稀疏，也不能太密集

# 空间划分 Spatial Partitions

Oct-Tree
KD-Tree  
BSP-Tree

# KD-Tree 预处理

先把场景的加速结构构建好，再进行渲染

网格数据存储在叶子节点中

KD-Tree的建立很难，因为判定一个三角形是否和一个立方体有交集很困难，所以这种结构最近十年越来越衰落

# Bounding Volumn Hierarchy

找到整个场景的包围盒

递归地将一系列对象划分为两个子集

重新计算子集的包围盒

在划分足够细致的情况下停止，将网格数据存储在叶子节点中

BVH对空间划分的包围盒有可能相交，要尽量减少空间上的重叠

如果划分一个节点？
- 选择划分的维度时，总是选择最长的轴
- 尽量划分为数量相等的物体，减少树结构的深度，使树更加平衡
- 利用快速选择 算法，可以用o(n)的时间复杂度获取中间大小的数字

# 辐射度量学 Radiometry-Motivation

光照在物理上的若干属性：Radiant flux 辐射通量、intensity 强度、irradiance 辐射照度、radiance 辐射亮度
- Energy : 单位 J
- Radiant Flux(Power)：单位时间的能量（单位时间内通过光子的数量），单位 W或者lumen
- Radiant Intensity：单位立体角Solid Angle的Power 单位 W/sr或者lumen/sr（candelas）
- Irradiance：物理表面接收的能量
- Radiance：光线在传播中的能量


