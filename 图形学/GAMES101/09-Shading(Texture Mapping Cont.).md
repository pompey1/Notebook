# 纹理应用（环境光照）

现代GPU中，纹理 = 内存 + 范围查询（滤波）

## 环境贴图

纹理可以用来表示环境光albedo

Sphere Map:环境光记录在一个球面上，会有扭曲问题（例如墨卡托投影的世界地图扭曲问题）

Cube Map:环境光记录在一个立方体（六个平面）上，没有扭曲问题，但是光照方向需要额外计算

## 法线贴图

法线贴图可以定义相对高度，通过贴图解压缩得到的法线进行着色，因为不改变几何信息，所以无法处理物体轮廓和阴影

在应用阶段通过对顶点求偏导得到每个顶点的切线

## 位移贴图 Displacement mapping

位移贴图会改变几何信息，但是要求模型足够细致，采样频率足够高，能够跟上纹理的变化速度

DirectX提供了动态的曲面细分，不需要应用阶段的模型足够精细，在渲染流水线的曲面细分阶段才会增加模型面数，从而提高对位移贴图的采样频率

## 3D纹理

通过三维的噪声函数可以定义一个三维的贴图

## 提前计算着色 Precompute Shading

比如环境光遮蔽贴图Ambient occlusion texture

## 3D纹理和体积渲染 Volumn Rendering

# 光栅化的阴影 Shadow Mapping

经典的阴影生成方法：以光源为虚拟摄像机对Scene进行一次光栅化得到场景的深度图，再进行正常的摄像机光栅化，将得到的图像**投射到光源**上得到深度再与之前得到的深度图进行比较，如果深度一致，说明像素在阴影外，如果深度不一致，说明像素在阴影中，比较完成以后得到的就是阴影图Shadow Map

由于深度值的比较是浮点数的比较，所以有一定的误差，引入bias可以改善但不能解决问题

阴影质量取决于Shadow Map的分辨率，同时阴影图和材质一样会有锯齿和走样问题

如果存在软阴影，一定是因为光源有一定的大小